{{ header }}{{ column_left }}
<div id="content">
  <div class="page-header">
    <div class="container-fluid">
      <div class="pull-right">
        <button type="submit" form="form-category" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary"><i class="fa fa-save"></i></button>
        <a href="{{ cancel }}" data-toggle="tooltip" title="{{ button_cancel }}" class="btn btn-default"><i class="fa fa-reply"></i></a></div>
      <h1>{{ heading_title }}</h1>
      <ul class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
        <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
        {% endfor %}
      </ul>
    </div>
  </div>
  <div class="container-fluid">
    {% if error_warning %}
    <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
      <button type="button" class="close" data-dismiss="alert">&times;</button>
    </div>
    {% endif %}
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title"><i class="fa fa-pencil"></i> {{ text_edit }}</h3>
      </div>
      <div class="panel-body">
        <form action="{{ action }}" method="post" enctype="multipart/form-data" id="form-category" class="form-horizontal">
          <ul class="nav nav-tabs">
            <li class="active"><a href="#tab-general" data-toggle="tab">{{ tab_general }}</a></li>
            <li><a href="#tab-data" data-toggle="tab">{{ tab_data }}</a></li>
            <li><a href="#tab-seo" data-toggle="tab">{{ tab_seo }}</a></li>
            <li style="display:none"><a href="#tab-design" data-toggle="tab">{{ tab_design }}</a></li>
          </ul>

          <input type="hidden" name="seo_score" class="seo_score" value="0">
          <input type="hidden" name="readability_score" class="readability_score" value="0">

          <div class="tab-content">
            <div class="tab-pane active" id="tab-general">
              <ul class="nav nav-tabs" id="language">
                {% for language in languages %}
                <li><a href="#language{{ language.language_id }}" data-toggle="tab"><img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" /> {{ language.name }}</a></li>
                {% endfor %}
              </ul>
              <div class="tab-content">
                {% for language in languages %}
                <div class="tab-pane" id="language{{ language.language_id }}">
                  <div class="form-group required">
                    <label class="col-sm-2 control-label" for="input-name{{ language.language_id }}">{{ entry_name }}</label>
                    <div class="col-sm-10">
                      <input type="text" name="category_description[{{ language.language_id }}][name]" value="{{ category_description[language.language_id] ? category_description[language.language_id].name }}" placeholder="{{ entry_name }}" id="input-name{{ language.language_id }}" class="form-control name" />
                      {% if error_name[language.language_id] %}
                      <div class="text-danger">{{ error_name[language.language_id] }}</div>
                      {% endif %}
                    </div>
                  </div>
                  <div class="form-group" >
                    <label class="col-sm-2 control-label" for="input-description{{ language.language_id }}">{{ entry_description }}</label>
                    <div class="col-sm-10">
                      <textarea name="category_description[{{ language.language_id }}][description]" placeholder="{{ entry_description }}" id="input-description{{ language.language_id }}" data-toggle="summernote" data-lang="{{ summernote }}" class="form-control category_description summernote">{{ category_description[language.language_id] ? category_description[language.language_id].description }}</textarea>

                      Total Words: <span id="description_words">0</span>

                    </div>
                  </div>
                  <div class="form-group required">
                    <label class="col-sm-2 control-label" for="input-meta-title{{ language.language_id }}">{{ entry_meta_title }}</label>
                    <div class="col-sm-10">
                      <input type="text" name="category_description[{{ language.language_id }}][meta_title]" value="{{ category_description[language.language_id] ? category_description[language.language_id].meta_title }}" placeholder="{{ entry_meta_title }}" id="input-meta-title{{ language.language_id }}" class="form-control meta_title" />
                      {% if error_meta_title[language.language_id] %}
                      <div class="text-danger">{{ error_meta_title[language.language_id] }}</div>
                      {% endif %}

                      Total Characters: <span id="meta_title_chars">0</span>

                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-meta-description{{ language.language_id }}">{{ entry_meta_description }}</label>
                    <div class="col-sm-10">
                      <textarea name="category_description[{{ language.language_id }}][meta_description]" rows="5" placeholder="{{ entry_meta_description }}" id="input-meta-description{{ language.language_id }}" class="form-control meta_description">{{ category_description[language.language_id] ? category_description[language.language_id].meta_description }}</textarea>

                      Total Characters: <span id="meta_description_chars">0</span>

                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-meta-keyword{{ language.language_id }}">{{ entry_meta_keyword }}</label>
                    <div class="col-sm-10">
                      <textarea name="category_description[{{ language.language_id }}][meta_keyword]" rows="5" placeholder="{{ entry_meta_keyword }}" id="input-meta-keyword{{ language.language_id }}" class="form-control">{{ category_description[language.language_id] ? category_description[language.language_id].meta_keyword }}</textarea>
                    </div>
                  </div>
                  <!-- custom category tags  -->
                  <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-tags{{ language.language_id }}">{{ entry_tags }}</label>
                    <div class="col-sm-10">
                      <input type="text" name="category_description[{{ language.language_id }}][tag]" value="{{ category_description[language.language_id] ? category_description[language.language_id].tag }}" placeholder="{{ entry_tags }}" id="input-tags{{ language.language_id }}" class="form-control tag" />
                    </div>
                  </div>
                  <!-- custom focus keyphrase -->
                  <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-focus-keyphrase{{ language.language_id }}">{{ text_focus_keyphrase }}</label>
                    <div class="col-sm-10">
                      <input type="text" name="category_description[{{ language.language_id }}][focus_keyphrase]" value="{{ category_description[language.language_id] ? category_description[language.language_id].focus_keyphrase }}" placeholder="{{ text_focus_keyphrase }}" id="input-focus-keyphrase{{ language.language_id }}" class="form-control focus_keyphrase" />
                    </div>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
            <div class="tab-pane" id="tab-data">
              <div class="form-group" style="display:none">
                <label class="col-sm-2 control-label" for="input-parent">{{ entry_parent }}</label>
                <div class="col-sm-10">
                  <input type="text" name="path" value="{{ path }}" placeholder="{{ entry_parent }}" id="input-parent" class="form-control" />
                  <input type="hidden" name="parent_id" value="{{ parent_id }}" />
                  {% if error_parent %}
                  <div class="text-danger">{{ error_parent }}</div>
                  {% endif %}
                </div>
              </div>
              <div class="form-group" style="display:none">
                <label class="col-sm-2 control-label" for="input-filter"><span data-toggle="tooltip" title="{{ help_filter }}">{{ entry_filter }}</span></label>
                <div class="col-sm-10">
                  <input type="text" name="filter" value="" placeholder="{{ entry_filter }}" id="input-filter" class="form-control" />
                  <div id="category-filter" class="well well-sm" style="height: 150px; overflow: auto;">
                    {% for category_filter in category_filters %}
                    <div id="category-filter{{ category_filter.filter_id }}"><i class="fa fa-minus-circle"></i> {{ category_filter.name }}
                      <input type="hidden" name="category_filter[]" value="{{ category_filter.filter_id }}" />
                    </div>
                    {% endfor %}
                  </div>
                </div>
              </div>
              <div class="form-group" style="display:none">
                <label class="col-sm-2 control-label">{{ entry_store }}</label>
                <div class="col-sm-10">
                  <div class="well well-sm" style="height: 150px; overflow: auto;">
                    {% for store in stores %}
                    <div class="checkbox">
                      <label>
                        {% if store.store_id in category_store %}
                        <input type="checkbox" name="category_store[]" value="{{ store.store_id }}" checked="checked" />
                        {{ store.name }}
                        {% else %}
                        <input type="checkbox" name="category_store[]" value="{{ store.store_id }}" />
                        {{ store.name }}
                        {% endif %}
                      </label>
                    </div>
                    {% endfor %}
                  </div>
                </div>
              </div>
              <div class="form-group" >
                <label class="col-sm-2 control-label">{{ entry_image }}</label>
                <div class="col-sm-10"><a href="" id="thumb-image" data-toggle="image" class="img-thumbnail"><img src="{{ thumb }}" alt="" title="" data-placeholder="{{ placeholder }}" /></a>
                  <input type="hidden" name="image" value="{{ image }}" id="input-image" />
                </div>
              </div>
              <div class="form-group">
                <label class="col-sm-2 control-label">{{ entry_image_custom_title }}</label>
                 <div class="col-sm-10">
                  <input type="text" name="image_custom_title" value="{{ image_custom_title }}" placeholder="{{ entry_image_custom_title }}" id="input-image-custom-title" class="form-control image_custom_title" />
                </div>
              </div>

              <div class="form-group">
                <label class="col-sm-2 control-label">{{ entry_image_custom_alt }}</label>
                 <div class="col-sm-10">
                  <input type="text" name="image_custom_alt" value="{{ image_custom_alt }}" placeholder="{{ entry_image_custom_alt }}" id="input-image-custom-alt" class="form-control image_custom_alt" />
                </div>
              </div>
              <div class="form-group" style="display:none">
                <label class="col-sm-2 control-label" for="input-top"><span data-toggle="tooltip" title="{{ help_top }}">{{ entry_top }}</span></label>
                <div class="col-sm-10">
                  <div class="checkbox">
                    <label>
                      {% if top %}
                      <input type="checkbox" name="top" value="1" checked="checked" id="input-top" />
                      {% else %}
                      <input type="checkbox" name="top" value="1" id="input-top" />
                      {% endif %}
                      &nbsp; </label>
                  </div>
                </div>
              </div>
              <div class="form-group" style="display:none">
                <label class="col-sm-2 control-label" for="input-column"><span data-toggle="tooltip" title="{{ help_column }}">{{ entry_column }}</span></label>
                <div class="col-sm-10">
                  <input type="text" name="column" value="{{ column }}" placeholder="{{ entry_column }}" id="input-column" class="form-control" />
                </div>
              </div>
              <div class="form-group" style="display:none">
                <label class="col-sm-2 control-label" for="input-sort-order">{{ entry_sort_order }}</label>
                <div class="col-sm-10">
                  <input type="text" name="sort_order" value="{{ sort_order }}" placeholder="{{ entry_sort_order }}" id="input-sort-order" class="form-control" />
                </div>
              </div>
              <div class="form-group">
                <label class="col-sm-2 control-label" for="input-status">{{ entry_status }}</label>
                <div class="col-sm-10">
                  <select name="status" id="input-status" class="form-control">
                    {% if status %}
                    <option value="1" selected="selected">{{ text_enabled }}</option>
                    <option value="0">{{ text_disabled }}</option>
                    {% else %}
                    <option value="1">{{ text_enabled }}</option>
                    <option value="0" selected="selected">{{ text_disabled }}</option>
                    {% endif %}
                  </select>
                </div>
              </div>
            </div>
            <div class="tab-pane" id="tab-seo">
              <div class="alert alert-info"><i class="fa fa-info-circle"></i> {{ text_keyword }}</div>
              <div class="table-responsive">
                <table class="table table-bordered table-hover">
                  <thead>
                    <tr>
                      <td class="text-left">{{ entry_store }}</td>
                      <td class="text-left">{{ entry_keyword }}</td>
                    </tr>
                  </thead>
                  <tbody>
                  {% for store in stores %}
                  <tr>
                    <td class="text-left">{{ store.name }}</td>
                    <td class="text-left">{% for language in languages %}
                      <div class="input-group"><span class="input-group-addon"><img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" /></span>
                        <input type="text" name="category_seo_url[{{ store.store_id }}][{{ language.language_id }}]" value="{% if category_seo_url[store.store_id][language.language_id] %}{{ category_seo_url[store.store_id][language.language_id] }}{% endif %}" placeholder="{{ entry_keyword }}" class="form-control seo_url" />
                      </div>
                      {% if error_keyword[store.store_id][language.language_id] %}
                      <div class="text-danger">{{ error_keyword[store.store_id][language.language_id] }}</div>
                      {% endif %}
                      {% endfor %}</td>
                  </tr>
                  {% endfor %}
                  </tbody>
                  
                </table>
              </div>
            </div>            
            <div class="tab-pane" id="tab-design" style="display:none">
              <div class="table-responsive">
                <table class="table table-bordered table-hover">
                  <thead>
                    <tr>
                      <td class="text-left">{{ entry_store }}</td>
                      <td class="text-left">{{ entry_layout }}</td>
                    </tr>
                  </thead>
                  <tbody>

                    {% for store in stores %}
                    <tr>
                      <td class="text-left">{{ store.name }}</td>
                      <td class="text-left"><select name="category_layout[{{ store.store_id }}]" class="form-control">
                          <option value=""></option>
                          {% for layout in layouts %}
                          {% if category_layout[store.store_id] and category_layout[store.store_id] == layout.layout_id %}
                          <option value="{{ layout.layout_id }}" selected="selected">{{ layout.name }}</option>
                          {% else %}
                          <option value="{{ layout.layout_id }}">{{ layout.name }}</option>
                          {% endif %}
                          {% endfor %}
                        </select></td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>

     <!-- Category SEO -->
    <div class="panel-group">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h4 class="panel-title">
            <a data-toggle="collapse" href="#seo_panel">{{ category_seo_text }}<span class="pull-right"><i class="fa fa-angle-down fa-lg"></i></span></a>
          </h4>
        </div>
        <div id="seo_panel" class="panel-collapse collapse in">
          <div class="panel-body">
            <!-- seo tabs -->
            <ul class="nav nav-tabs">
              <li class="active"><a data-toggle="tab" href="#keyphrase_panel"  class="keyphrase_panel"><i class="fa fa-circle "></i> {{ text_focus_keyphrase }}</a></li>
              <li><a data-toggle="tab" href="#readability_panel" class="readability_panel"><i class="fa fa-circle "></i> {{ text_readability }}</a></li>
            </ul>
            <!-- seo messages -->
            <div class="tab-content">
              <div id="readability_panel" class="tab-pane fade in">
                <!-- Readability Analysis -->
                <div class="panel-group">
                  <div class="panel panel-default">
                    
                    <div id="readability_panel" class="panel-collapse collapse in">
                      <div class="panel-body">
                        <!-- Readability Problems -->
                        <div class="panel panel-danger">
                          <div class="panel-heading">
                            <h4 class="panel-title">
                              <a data-toggle="collapse" href="#readability_problems">{{ text_problems }} (<span id="readability_problems_items"></span>) <i class="fa fa-angle-down fa-lg pull-right"></i> </a>
                            </h4>
                          </div>
                          <div id="readability_problems" class="panel-collapse collapse in">
                            <div class="panel-body">
                              <ul class="list-group" id="readability_problems_list">
                               <li class="list-group-item" id="subheading_problem"><i class="fa fa-circle text-danger"></i> {{ subheading_problem }}</li> 
                               <li class="list-group-item" id="no_transition_words_problem"><i class="fa fa-circle text-danger"></i> {{ no_transition_words_problem }}</li>
                                <li class="list-group-item" id="subheading_distribution_problem"><i class="fa fa-circle text-danger"></i> {{ subheading_distribution_problem }}</li>
                                <li class="list-group-item" id="paragraph_length_problem"><i class="fa fa-circle text-danger"></i> {{ paragraph_length_problem }}</li>
                                <li class="list-group-item" id="ease_reading_problem"><i class="fa fa-circle text-danger"></i> {{ ease_reading_problem }}</li>
                              </ul>
                            </div>
                          </div>
                        </div>
                       
                        <!-- Readability Improvments -->
                        <div class="panel panel-warning">
                          <div class="panel-heading">
                            <h4 class="panel-title">
                              <a data-toggle="collapse" href="#readability_improvements">{{ text_improvements }} (<span id="readability_improvements_items"></span>) <i class="fa fa-angle-down fa-lg pull-right"></i> </a>
                            </h4>
                          </div>
                          <div id="readability_improvements" class="panel-collapse collapse in">
                            <div class="panel-body">
                              <ul class="list-group" id="readability_improvements_list">
                                <li class="list-group-item" id="sentence_length_improvement"><i class="fa fa-circle text-warning"></i> {{ sentence_length_improvement }}</li>
                                <li class="list-group-item" id="ease_reading_improvement"><i class="fa fa-circle text-warning"></i> {{ ease_reading_improvement }}</li>
                              </ul>
                            </div>
                          </div>
                        </div>
                        
                        <!-- Readability Good Results -->
                       <div class="panel panel-success">
                          <div class="panel-heading">
                            <h4 class="panel-title">
                              <a data-toggle="collapse" href="#readability_good">{{ text_good_results }} (<span id="readability_good_items"></span>) <i class="fa fa-angle-down fa-lg pull-right"></i> </a>
                            </h4>
                          </div>
                          <div id="readability_good" class="panel-collapse collapse in">
                            <div class="panel-body">
                              <ul class="list-group" id="readability_good_list">
                                <li class="list-group-item" id="ease_reading_good"><i class="fa fa-circle text-success"></i> {{ ease_reading_good }}</li>
                                <li class="list-group-item" id="subheading_good"><i class="fa fa-circle text-success"></i> {{ subheading_good }}</li>
                                <li class="list-group-item" id="paragraph_length_good"><i class="fa fa-circle text-success"></i> {{ paragraph_length_good }}</li>
                                <li class="list-group-item" id="sentence_length_good"><i class="fa fa-circle text-success"></i> {{ sentence_length_good }}</li>
                                <li class="list-group-item" id="transition_words_good"><i class="fa fa-circle text-success"></i> {{ transition_words_good }}</li>
                              </ul>
                            </div>
                          </div>
                        </div>

                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div id="keyphrase_panel" class="tab-pane fade in active">
                 <!-- Focus Keyphrase -->
                <div class="panel-group">
                  <div class="panel panel-default">
                    <div id="keyphrase_panel2" class="panel-collapse collapse in">
                      <div class="panel-body">
                        <!-- Focus Keyphrase Problems -->
                        <div class="panel panel-danger">
                          <div class="panel-heading">
                            <h4 class="panel-title">
                              <a data-toggle="collapse" href="#keyphrase_problems">{{ text_problems }} (<span id="keyphrase_problems_items"></span>) <i class="fa fa-angle-down fa-lg pull-right"></i> </a>
                            </h4>
                          </div>
                          <div id="keyphrase_problems" class="panel-collapse collapse in">
                            <div class="panel-body" >
                              <ul class="list-group" id="keyphrase_problems_list" >
                                <li class="list-group-item" id="no_description_problem"><i class="fa fa-circle text-danger"></i> {{ no_description_problem }}</li>
                                <li class="list-group-item" id="no_image_problem"><i class="fa fa-circle text-danger"></i> {{ no_image_problem }}</li>
                                <li class="list-group-item" id="internal_link_problem" ><i class="fa fa-circle text-danger"></i> {{ internal_link_problem }}</li>
                                <li class="list-group-item" id="outbound_link_problem"><i class="fa fa-circle text-danger"></i> {{ outbound_link_problem }}</li>
                                <li class="list-group-item" id="keyphrase_length_problem"><i class="fa fa-circle text-danger"></i> {{ keyphrase_length_problem }}</li>
                                <li class="list-group-item" id="keyphrase_over_density_problem"><i class="fa fa-circle text-danger"></i> {{ keyphrase_over_density_problem }}</li>
                                <li class="list-group-item" id="meta_description_length_problem"><i class="fa fa-circle text-danger"></i> {{ meta_description_length_problem }}</li>
                                <li class="list-group-item" id="meta_description_length_over_problem"><i class="fa fa-circle text-danger"></i> {{ meta_description_length_over_problem }}</li>
                                <li class="list-group-item" id="keyphrase_in_meta_description_problem"><i class="fa fa-circle text-danger"></i> {{ keyphrase_in_meta_description_problem }}</li>
                                <li class="list-group-item" id="no_meta_title_problem"><i class="fa fa-circle text-danger"></i> {{ no_meta_title_problem }}</li>
                                <li class="list-group-item" id="meta_title_width_problem"><i class="fa fa-circle text-danger"></i> {{ meta_title_width_problem }}</li>
                                <li class="list-group-item" id="keyphrase_not_in_title_problem"><i class="fa fa-circle text-danger"></i> {{ keyphrase_not_in_title_problem }}</li>
                                <li class="list-group-item" id="no_slug_problem"><i class="fa fa-circle text-danger"></i> {{ no_slug_problem }}</li>
                                <li class="list-group-item" id="keyphrase_in_slug_problem"><i class="fa fa-circle text-danger"></i> {{ keyphrase_in_slug_problem }}</li>
                                <li class="list-group-item" id="h1_tag_problem"><i class="fa fa-circle text-danger"></i> {{ h1_tag_problem }}</li>
                              </ul>
                            </div>
                          </div>
                        </div>
                       
                        <!-- Focus Keyphrase Improvments -->
                        <div class="panel panel-warning">
                          <div class="panel-heading">
                            <h4 class="panel-title">
                              <a data-toggle="collapse" href="#keyphrase_improvements">{{ text_improvements }} (<span id="keyphrase_improvements_items"></span>) <i class="fa fa-angle-down fa-lg pull-right"></i> </a>
                            </h4>
                          </div>
                          <div id="keyphrase_improvements" class="panel-collapse collapse in">
                            <div class="panel-body">
                              <ul class="list-group" id="keyphrase_improvements_list">
                                <li class="list-group-item" id="image_title_improvement"><i class="fa fa-circle text-warning"></i> {{ image_title_improvement }}</li>
                                <li class="list-group-item" id="image_alt_improvement"><i class="fa fa-circle text-warning"></i> {{ image_alt_improvement }}</li>
                                <li class="list-group-item" id="no_image_title_improvement"><i class="fa fa-circle text-warning"></i> {{ no_image_title_improvement }}</li>
                                <li class="list-group-item" id="no_image_alt_improvement"><i class="fa fa-circle text-warning"></i> {{ no_image_alt_improvement }}</li>
                                <li class="list-group-item" id="meta_title_width_improvement"><i class="fa fa-circle text-warning"></i> {{ meta_title_width_improvement }}</li>
                                <li class="list-group-item" id="keyphrase_in_slug_improvement"><i class="fa fa-circle text-warning"></i> {{ keyphrase_in_slug_improvement }}</li>
                                <li class="list-group-item" id="keyphrase_in_title_improvement"><i class="fa fa-circle text-warning"></i> {{ keyphrase_in_title_improvement }}</li>
                                <li class="list-group-item" id="meta_description_length_under_improvement"><i class="fa fa-circle text-warning"></i> {{ meta_description_length_under_improvement }}</li>
                                <li class="list-group-item" id="meta_description_length_over_improvement"><i class="fa fa-circle text-warning"></i> {{ meta_description_length_over_improvement }}</li>
                                <li class="list-group-item" id="description_far_below_length_improvement"><i class="fa fa-circle text-warning"></i> {{ description_far_below_length_improvement }}</li>
                                <li class="list-group-item" id="description_below_length_improvement"><i class="fa fa-circle text-warning"></i> {{ description_below_length_improvement }}</li>
                                <li class="list-group-item" id="description_slight_below_length_improvement"><i class="fa fa-circle text-warning"></i> {{ description_slight_below_length_improvement }}</li>
                                <li class="list-group-item" id="keyphrase_length_improvement"><i class="fa fa-circle text-warning"></i> {{ keyphrase_length_improvement }}</li>
                                <li class="list-group-item" id="no_previous_keyphrase_improvement"><i class="fa fa-circle text-warning"></i> {{ no_previous_keyphrase_improvement }}</li>
                                <li class="list-group-item" id="h1_tag_improvement"><i class="fa fa-circle text-warning"></i> {{ h1_tag_improvement }}</li>
                                <li class="list-group-item" id="subheading_tag_improvement"><i class="fa fa-circle text-warning"></i> {{ subheading_tag_improvement }}</li>
                                <li class="list-group-item" id="keyphrase_low_density_improvement"><i class="fa fa-circle text-warning"></i> {{ keyphrase_low_density_improvement }}</li>
                                <li class="list-group-item" id="keyphrase_in_intro_improvement"><i class="fa fa-circle text-warning"></i> {{ keyphrase_in_intro_improvement }}</li>
                              </ul>
                            </div>
                          </div>
                        </div>
                        
                        <!-- Focus Keyphrase Good Results -->
                       <div class="panel panel-success">
                          <div class="panel-heading">
                            <h4 class="panel-title">
                              <a data-toggle="collapse" href="#keyphrase_good"> {{ text_good_results }} (<span id="keyphrase_good_items"></span>) <i class="fa fa-angle-down fa-lg pull-right"></i></a>
                            </h4>
                          </div>
                          <div id="keyphrase_good" class="panel-collapse collapse in">
                            <div class="panel-body">
                              <ul class="list-group" id="keyphrase_good_list">
                                <li class="list-group-item" id="slug_good"><i class="fa fa-circle text-success"></i> {{ slug_good }}</li>
                                <li class="list-group-item" id="outbound_link_good"><i class="fa fa-circle text-success"></i> {{ outbound_link_good }}</li>
                                <li class="list-group-item" id="internal_link_good"><i class="fa fa-circle text-success"></i> {{ internal_link_good }}</li>
                                <li class="list-group-item" id="keyphrase_in_intro_good"><i class="fa fa-circle text-success"></i> {{ keyphrase_in_intro_good }}</li>
                                <li class="list-group-item" id="keyphrase_in_meta_description_good"><i class="fa fa-circle text-success"></i> {{ keyphrase_in_meta_description_good }}</li>
                                <li class="list-group-item" id="keyphrase_length_good"><i class="fa fa-circle text-success"></i> {{ keyphrase_length_good }}</li>
                                <li class="list-group-item" id="meta_title_width_good"><i class="fa fa-circle text-success"></i> {{ meta_title_width_good }}</li>
                                <li class="list-group-item" id="meta_description_length_good"><i class="fa fa-circle text-success"></i> {{ meta_description_length_good }}</li>
                                <li class="list-group-item" id="no_previous_keyphrase_good"><i class="fa fa-circle text-success"></i> {{ no_previous_keyphrase_good }}</li>
                                <li class="list-group-item" id="keyphrase_exact_in_title_good"><i class="fa fa-circle text-success"></i> {{ keyphrase_exact_in_title_good }}</li>
                                <li class="list-group-item" id="keyphrase_density_good"><i class="fa fa-circle text-success"></i> {{ keyphrase_density_good }}</li>
                                <li class="list-group-item" id="keyphrase_in_slug_good"><i class="fa fa-circle text-success"></i> {{ keyphrase_in_slug_good }}</li>
                                <li class="list-group-item" id="description_length_good"><i class="fa fa-circle text-success"></i> {{ description_length_good }}</li>
                                <li class="list-group-item" id="image_alt_good"><i class="fa fa-circle text-success"></i> {{ image_alt_good }}</li>
                                <li class="list-group-item" id="image_title_good"><i class="fa fa-circle text-success"></i> {{ image_title_good }}</li>
                                <li class="list-group-item" id="h1_tag_good"><i class="fa fa-circle text-success"></i> {{ h1_tag_good }}</li>
                                <li class="list-group-item" id="subheading_tag_good"><i class="fa fa-circle text-success"></i> {{ subheading_tag_good }}</li>
                              </ul>
                            </div>
                          </div>
                        </div>

                        <ul id="focus_keyphrases" style="display:none">
                          {% for focus_keyphrase in focus_keyphrases %}
                            <li >{{ focus_keyphrase.focus_keyphrase }}</li>
                          {% endfor %}
                        </ul>

                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
  </div>
  <link href="view/javascript/codemirror/lib/codemirror.css" rel="stylesheet" />
  <link href="view/javascript/codemirror/theme/monokai.css" rel="stylesheet" />
  <script type="text/javascript" src="view/javascript/codemirror/lib/codemirror.js"></script> 
  <script type="text/javascript" src="view/javascript/codemirror/lib/xml.js"></script> 
  <script type="text/javascript" src="view/javascript/codemirror/lib/formatting.js"></script> 
  
  <script type="text/javascript" src="view/javascript/summernote/summernote.js"></script>
  <link href="view/javascript/summernote/summernote.css" rel="stylesheet" />
  <script type="text/javascript" src="view/javascript/summernote/summernote-image-attributes.js"></script>
  <script type="text/javascript" src="view/javascript/summernote/opencart.js"></script>
  
  <script type="text/javascript"><!--
$('input[name=\'path\']').autocomplete({
	'source': function(request, response) {
		$.ajax({
			url: 'index.php?route=catalog/category/autocomplete&user_token={{ user_token }}&filter_name=' +  encodeURIComponent(request),
			dataType: 'json',
			success: function(json) {
				json.unshift({
					category_id: 0,
					name: '{{ text_none }}'
				});

				response($.map(json, function(item) {
					return {
						label: item['name'],
						value: item['category_id']
					}
				}));
			}
		});
	},
	'select': function(item) {
		$('input[name=\'path\']').val(item['label']);
		$('input[name=\'parent_id\']').val(item['value']);
	}
});
//--></script>
  <script type="text/javascript"><!--
$('input[name=\'filter\']').autocomplete({
	'source': function(request, response) {
		$.ajax({
			url: 'index.php?route=catalog/filter/autocomplete&user_token={{ user_token }}&filter_name=' +  encodeURIComponent(request),
			dataType: 'json',
			success: function(json) {
				response($.map(json, function(item) {
					return {
						label: item['name'],
						value: item['filter_id']
					}
				}));
			}
		});
	},
	'select': function(item) {
		$('input[name=\'filter\']').val('');

		$('#category-filter' + item['value']).remove();

		$('#category-filter').append('<div id="category-filter' + item['value'] + '"><i class="fa fa-minus-circle"></i> ' + item['label'] + '<input type="hidden" name="category_filter[]" value="' + item['value'] + '" /></div>');
	}
});

$('#category-filter').delegate('.fa-minus-circle', 'click', function() {
	$(this).parent().remove();
});
//--></script>
  <script type="text/javascript"><!--
$('#language a:first').tab('show');
//--></script>


<script type="text/javascript">
    
    // focus keyphrase
    var focus_keyphrase = $('input[type="text"].focus_keyphrase').val().toLowerCase().trim();

    var focus_keyphrase_words = 0;

    if(focus_keyphrase != ''){
      focus_keyphrase_words = focus_keyphrase.match(/\S+/g).length;
    }

    // focus keyphrase on change
    $('input[type="text"].focus_keyphrase').on('keyup', function(){
        
        focus_keyphrase = $(this).val().toLowerCase().trim();
  
        if(focus_keyphrase != ''){
          focus_keyphrase_words = focus_keyphrase.match(/\S+/g).length;
        }

        focusKeyPhrase(focus_keyphrase, focus_keyphrase_words);

        checkPreviousKeyphrases(focus_keyphrase);

        metaTitleKeyphrase(meta_title, focus_keyphrase);

        metaDescriptionKeyphrase(meta_description, focus_keyphrase);

        categoryDescription(description_words, description);

        keyphraseInIntro(description_html, description, focus_keyphrase, intro_start_index, intro_end_index);

        headingTags(description_html, focus_keyphrase);
      
        subHeadingTags(description_html, focus_keyphrase);

        imageAttributes(image_custom_title,image_custom_alt, focus_keyphrase);

        seoUrlKeyphrase(slug, focus_keyphrase);

        checkKeyphraseDensity(focus_keyphrase);

        countMessageItems();

    });


    // meta title
    var meta_title = $("input[type='text'].meta_title").val().toLowerCase();

     // meta title width
    var meta_title_width = 0;

    if(meta_title != ''){
        meta_title_width = meta_title.split('').length;
    }

    $("#meta_title_chars").text(meta_title_width);

    // meta title on change
    $("input[type='text'].meta_title").on('keyup', function(){
        
      meta_title = $(this).val().toLowerCase();

      meta_title_width = meta_title.split('').length; 

      $("#meta_title_chars").text(meta_title_width);

      metaTitleWidth(meta_title_width);

      metaTitleKeyphrase(meta_title, focus_keyphrase);

      focusKeyPhrase(focus_keyphrase, focus_keyphrase_words);
      
      checkKeyphraseDensity(focus_keyphrase);
      
      countMessageItems();

    });


    // meta description
    var meta_description = $('textarea.meta_description').val().toLowerCase();

    // meta description length
    var meta_description_chars  = 0;

    if(meta_description != ''){
        meta_description_chars = meta_description.split('').length;
    }

    // meta description on change
    $("textarea.meta_description").on('keyup', function(){
          
      meta_description = $(this).val().toLowerCase();

      if($(this).val() != ''){
            meta_description_chars = $(this).val().split('').length;
      }else{
          meta_description_chars = 0;
      }

      metaDescriptionLength(meta_description_chars);

      metaDescriptionKeyphrase(meta_description, focus_keyphrase);
      
      checkKeyphraseDensity(focus_keyphrase);
      
      countMessageItems();

    });



    // seo url / slug
    var seo_url = $("input[type='text'].seo_url").val();
    var slug = seo_url.replace(/\-+/g, ' ');

    if(seo_url != ''){
      seoUrlKeyphrase(slug, focus_keyphrase);
    }else{
      $("#no_slug_problem").removeClass('hidden');
      $("#slug_good").addClass('hidden');
      $("#keyphrase_in_slug_problem").addClass('hidden');
      $("#keyphrase_in_slug_good").addClass('hidden');
      $("#keyphrase_in_slug_improvement").addClass('hidden')

    }

    // seo url on change
    $("input[type='text'].seo_url").on('keyup', function(){
      
      seo_url = $(this).val();

      slug = seo_url.replace(/\-+/g, ' ');

      seoUrlKeyphrase(slug, focus_keyphrase);
      
      checkKeyphraseDensity(focus_keyphrase);
      
      countMessageItems();

    });


    
    function focusKeyPhrase(focus_keyphrase, focus_keyphrase_words) {

      if(focus_keyphrase != ''){

        $("#keyphrase_length_problem").addClass('hidden');

        if(focus_keyphrase_words >= 2 && focus_keyphrase_words <= 4 ) {

          $("#keyphrase_length_good").removeClass('hidden');
          $("#keyphrase_length_improvement").addClass('hidden');
          $("#keyphrase_length_problem").addClass('hidden');

        }else if(focus_keyphrase_words > 4) {

          $("#keyphrase_length_improvement").removeClass('hidden');
          $("#keyphrase_length_good").addClass('hidden');
          $("#keyphrase_length_problem").addClass('hidden');

        }else{

          $("#keyphrase_length_good").addClass('hidden');
          $("#keyphrase_length_improvement").addClass('hidden');

        }

      }else {
        $("#keyphrase_length_problem").removeClass('hidden');
        $("#keyphrase_length_improvement").addClass('hidden');
        $("#keyphrase_over_density_problem").addClass('hidden');
        $("#keyphrase_density_good").addClass('hidden');
        $("#keyphrase_in_meta_description_good").addClass('hidden');
        $("#keyphrase_exact_in_title_good").addClass('hidden');
        $("#keyphrase_in_slug_good").addClass('hidden');
        $("#keyphrase_in_intro_good").addClass('hidden');
        $("#keyphrase_in_intro_improvement").addClass('hidden');
        $("#keyphrase_low_density_improvement").addClass('hidden');
        $("#no_previous_keyphrase_good").addClass('hidden');
        $("#keyphrase_length_good").addClass('hidden');
        $("#h1_tag_good").addClass('hidden');
        $("#subheading_tag_good").addClass('hidden');

      }

    }

    function checkPreviousKeyphrases(focus_keyphrase){

      var keyphrases = [];
      var keyphrase ='';

      var count = 0;

      $( "#focus_keyphrases li" ).each(function( index ) {

        previous_keyphrase = $(this).text().toLowerCase();
        
        keyphrases.push(previous_keyphrase);

      });

      if(focus_keyphrase != '' && keyphrases != ''){

          if(keyphrases.indexOf(focus_keyphrase) == -1){

            $("#no_previous_keyphrase_good").removeClass('hidden');
            $("#no_previous_keyphrase_improvement").addClass('hidden');

          }else{

            $("#no_previous_keyphrase_good").addClass('hidden');
            $("#no_previous_keyphrase_improvement").removeClass('hidden');

          }

        }else{

            $("#no_previous_keyphrase_good").addClass('hidden');
            $("#no_previous_keyphrase_improvement").addClass('hidden');

        }

    }


    function metaTitleKeyphrase(meta_title, focus_keyphrase) {

      if(focus_keyphrase != '' && meta_title != ''){

        if(meta_title.indexOf(focus_keyphrase) == 0 ){

          $("#keyphrase_exact_in_title_good").removeClass('hidden');
          $("#keyphrase_in_title_improvement").addClass('hidden');
          $("#keyphrase_not_in_title_problem").addClass('hidden');

        }else if(meta_title.indexOf(focus_keyphrase) != -1){

          $("#keyphrase_in_title_improvement").removeClass('hidden');
          $("#keyphrase_not_in_title_problem").addClass('hidden');
          $("#keyphrase_exact_in_title_good").addClass('hidden');

        }
        else{

          $("#keyphrase_not_in_title_problem").removeClass('hidden');
          $("#keyphrase_exact_in_title_good").addClass('hidden');
          $("#keyphrase_in_title_improvement").addClass('hidden');

        }

      }else{

          $("#keyphrase_not_in_title_problem").addClass('hidden');
          $("#keyphrase_exact_in_title_good").addClass('hidden');
          $("#keyphrase_in_title_improvement").addClass('hidden');

      }
      
    }

    function metaTitleWidth(meta_title_width) {
     
      if(meta_title_width < 1 ){

        $("#no_meta_title_problem").removeClass('hidden');
        $("#keyphrase_not_in_title_problem").addClass('hidden');
        $("#keyphrase_in_title_improvement").addClass('hidden');
        $("#keyphrase_exact_in_title_good").addClass('hidden');
        $("#meta_title_width_good").addClass('hidden');
        $("#meta_title_width_improvement").addClass('hidden');
        $("#meta_title_width_problem").addClass('hidden');

      }else if(meta_title_width >= 1 && meta_title_width < 47){

        $("#meta_title_width_improvement").removeClass('hidden');
        $("#meta_title_width_good").addClass('hidden');
        $("#meta_title_width_problem").addClass('hidden');
        $("#no_meta_title_problem").addClass('hidden');

      }else if(meta_title_width >= 47 && meta_title_width <= 70){

        $("#meta_title_width_good").removeClass('hidden');
        $("#meta_title_width_improvement").addClass('hidden');
        $("#meta_title_width_problem").addClass('hidden');
        $("#no_meta_title_problem").addClass('hidden');

      }else {

        $("#meta_title_width_problem").removeClass('hidden');
        $("#meta_title_width_good").addClass('hidden');
        $("#meta_title_width_improvement").addClass('hidden');
        $("#no_meta_title_problem").addClass('hidden');

      }

    
    }


    function metaDescriptionKeyphrase(meta_description, focus_keyphrase){

      if(focus_keyphrase !=''){

        if(meta_description !=''){

          if(meta_description.toLowerCase().search(focus_keyphrase) != -1){
            $("#keyphrase_in_meta_description_good").removeClass('hidden');
            $("#keyphrase_in_meta_description_problem").addClass('hidden');
          }else{
            $("#keyphrase_in_meta_description_problem").removeClass('hidden');
            $("#keyphrase_in_meta_description_good").addClass('hidden');
          }
  
        }else{
            $("#keyphrase_in_meta_description_problem").addClass('hidden');
            $("#keyphrase_in_meta_description_good").addClass('hidden');
        }
        
      }else{
          $("#keyphrase_in_meta_description_good").addClass('hidden');
          $("#keyphrase_in_meta_description_problem").addClass('hidden');
      }

    }

    function metaDescriptionLength(meta_description_chars) {

      $('#meta_description_chars').text(meta_description_chars);

      if(meta_description_chars >= 1 && meta_description_chars < 120 ){
          
          $("#meta_description_length_under_improvement").removeClass('hidden');
          $("#meta_description_length_problem").addClass('hidden');
          $("#meta_description_length_over_problem").addClass('hidden');
          $("#meta_description_length_over_improvement").addClass('hidden');
          $("#keyphrase_in_meta_description_problem").addClass('hidden');
          $("#keyphrase_in_meta_description_good").addClass('hidden');
          $("#meta_description_length_good").addClass('hidden');

      }else if(meta_description_chars >= 120 && meta_description_chars <= 200){
          
          $("#meta_description_length_good").removeClass('hidden');
          $("#meta_description_length_over_improvement").addClass('hidden');
          $("#meta_description_length_under_improvement").addClass('hidden');
          $("#meta_description_length_problem").addClass('hidden');
          $("#meta_description_length_over_problem").addClass('hidden');
          $("#keyphrase_in_meta_description_problem").addClass('hidden');
          $("#keyphrase_in_meta_description_good").addClass('hidden');

      }else if(meta_description_chars > 200 && meta_description_chars <= 320 ){

          $("#meta_description_length_over_improvement").removeClass('hidden');
          $("#meta_description_length_under_improvement").addClass('hidden');
          $("#meta_description_length_over_problem").addClass('hidden');
          $("#meta_description_length_problem").addClass('hidden');
          $("#meta_description_length_good").addClass('hidden');
          $("#keyphrase_in_meta_description_problem").addClass('hidden');
          $("#keyphrase_in_meta_description_good").addClass('hidden');

      } else if(meta_description_chars > 320){ 

          $("#meta_description_length_over_problem").removeClass('hidden');
          $("#meta_description_length_over_improvement").addClass('hidden');
          $("#meta_description_length_under_improvement").addClass('hidden');
          $("#meta_description_length_problem").addClass('hidden');
          $("#meta_description_length_good").addClass('hidden');
          $("#keyphrase_in_meta_description_problem").addClass('hidden');
          $("#keyphrase_in_meta_description_good").addClass('hidden');

      }else{

          $("#meta_description_length_problem").removeClass('hidden');
          $("#meta_description_length_over_problem").addClass('hidden');
          $("#meta_description_length_good").addClass('hidden');
          $("#meta_description_length_under_improvement").addClass('hidden');
          $("#meta_description_length_over_improvement").addClass('hidden');
          $("#keyphrase_in_meta_description_good").addClass('hidden');
          $("#keyphrase_in_meta_description_problem").addClass('hidden');

      }
  }

    function categoryDescription(description_words, description) {
      // good   

      if(description != ''){
        
        $("#no_description_problem").addClass('hidden');

        if(description_words >= 1 && description_words < 200 ){
          
          $("#description_far_below_length_improvement").removeClass('hidden');
          $("#description_below_length_improvement").addClass('hidden');
          $("#description_slight_below_length_improvement").addClass('hidden');
          $("#description_length_good").addClass('hidden');

        }else if(description_words >= 200 && description_words < 250 ){
          
          $("#description_below_length_improvement").removeClass('hidden');
          $("#description_slight_below_length_improvement").addClass('hidden');
          $("#description_far_below_length_improvement").addClass('hidden');
          $("#description_length_good").addClass('hidden');

        }else if(description_words >= 250 && description_words < 300){

          $("#description_slight_below_length_improvement").removeClass('hidden');
          $("#description_far_below_length_improvement").addClass('hidden');
          $("#description_below_length_improvement").addClass('hidden');
          $("#description_length_good").addClass('hidden');

        }else if(description_words >= 300){

          $("#description_length_good").removeClass('hidden');
          $("#description_far_below_length_improvement").addClass('hidden');
          $("#description_below_length_improvement").addClass('hidden');
          $("#description_slight_below_length_improvement").addClass('hidden');

        }else{

          $("#description_far_below_length_improvement").removeClass('hidden');
          $("#description_below_length_improvement").addClass('hidden');
          $("#description_slight_below_length_improvement").addClass('hidden');
          $("#description_length_good").addClass('hidden');
          
        }
       
      }else{
          $("#no_description_problem").removeClass('hidden');
          $("#description_length_good").addClass('hidden');
          $("#description_far_below_length_improvement").addClass('hidden');
          $("#description_below_length_improvement").addClass('hidden');
          $("#description_slight_below_length_improvement").addClass('hidden');
      }

    }

     function checkLinks(description_html) {

      if(description != ''){

      // check for internal links
        if(description_html.indexOf('{{ www_store_non_secure_url }}') != -1 ||
          description_html.indexOf('{{ www_store_secure_url }}') != -1 ||
          description_html.indexOf('{{ store_non_secure_url }}') != -1 ||
          description_html.indexOf('{{ store_secure_url }}') != -1){

          $("#internal_link_good").removeClass('hidden');
          $("#internal_link_problem").addClass('hidden');
        }else{
            $("#internal_link_problem").removeClass('hidden');
            $("#internal_link_good").addClass('hidden');
        }
        
        var link = 'href=';

        var store_links = ['{{ www_store_non_secure_url }}', '{{ www_store_secure_url }}','{{ store_non_secure_url }}', '{{ store_secure_url }}'];

        var total_links = 0;
        var store_link_count = 0;

        var link_index  = 0;
        var store_link_index  = 0;

          // total links
          while(true){

              link_index = description_html.indexOf(link, link_index);

              if(link_index != -1){ 
                total_links++; 
                link_index += link.length;
              }
              else{
                break;
              }
          }

          // internal links
          $(store_links).each(function(index){
            // just to check store links are not same
            if(store_links[index] != store_links[index-1]){

              while(true){

                store_link_index = description_html.indexOf(store_links[index], store_link_index);

                if(store_link_index != -1){ 
                  store_link_count++; 
                  store_link_index += store_links[index].length;
                }
                else{
                  break;
                }
              }

            }

          });


          // external links
          if(total_links > store_link_count){
              $("#outbound_link_good").removeClass('hidden');
              $("#outbound_link_problem").addClass('hidden');
          }else{
              $("#outbound_link_problem").removeClass('hidden');
              $("#outbound_link_good").addClass('hidden');
          }

      }else{
        $("#internal_link_problem").addClass('hidden');
        $("#internal_link_good").addClass('hidden');
        $("#outbound_link_good").addClass('hidden');
        $("#outbound_link_problem").addClass('hidden');
        $("#keyphrase_in_intro_improvement").addClass('hidden');

      }

    }

    function keyphraseInIntro(description_html, description, focus_keyphrase, intro_start_index, intro_end_index) {

      description_intro_paragraph = description_html.substr(intro_start_index, intro_end_index).toLowerCase();

      if(description != ''){

        if(focus_keyphrase != ''){

          if(description_intro_paragraph.indexOf(focus_keyphrase) != -1){
            $("#keyphrase_in_intro_good").removeClass('hidden');
            $("#keyphrase_in_intro_improvement").addClass('hidden');
          }else{
            $("#keyphrase_in_intro_improvement").removeClass('hidden');
            $("#keyphrase_in_intro_good").addClass('hidden');
          }

        }
      }
      
      

    }

    // for readability
    function checkSubHeadings(description_html) {

      var count_subheading  = 0;

       if(description != ''){
          
          if( description_html.indexOf('<h2') != -1 ||
              description_html.indexOf('<h3') != -1 ||
              description_html.indexOf('<h4') != -1 ||
              description_html.indexOf('<h5') != -1 ||
              description_html.indexOf('<h6') != -1)
            {
              count_subheading = 1;
            }else{
              count_subheading = 0;
            }

          if(description_words > 300 && count_subheading == 1){

            $("#subheading_good").removeClass('hidden');
            $("#subheading_problem").addClass('hidden');
            
          }else if(description_words < 300 && count_subheading == 1){
              $("#subheading_good").removeClass('hidden');
              $("#subheading_problem").addClass('hidden');
          }else{
              $("#subheading_problem").removeClass('hidden');
              $("#subheading_good").addClass('hidden');
          }

       }else{
            $("#subheading_problem").addClass('hidden');
            $("#subheading_good").addClass('hidden');
       }

    }

    function headingTags(description_html, focus_keyphrase){

      
      if(description != ''){
          
          var h1_start_indexes = [];
          var h1_end_indexes = [];

          var h1_open = '<h1';
          var h1_close = '</h1>';

          var h1_open_count = 0;
          var h1_open_index  = 0;

          var h1_close_count = 0;
          var h1_close_index  = 0;

            
          while(true){

              h1_open_index = description_html.indexOf(h1_open, h1_open_index);

              if(h1_open_index != -1){ 
                h1_open_count++; 
                
                h1_start_indexes.push(h1_open_index);

                h1_open_index += h1_open.length;
              }
              else{
                break;
              }
          }


          while(true){

              h1_close_index = description_html.indexOf(h1_close, h1_close_index);

              if(h1_close_index != -1){ 
                h1_close_count++; 
                
                h1_end_indexes.push(h1_close_index);

                h1_close_index += h1_close.length;
              }
              else{
                break;
              }
          }

          if(h1_start_indexes !='' && h1_open_count != 0){
            
            $(h1_start_indexes).each(function(index){

                var h1_tag = description_html.substring(h1_start_indexes[index], h1_end_indexes[index]);
                
                if(focus_keyphrase != ''){

                  if(h1_tag.toLowerCase().indexOf(focus_keyphrase) != -1){
                      $("#h1_tag_good").removeClass('hidden');
                      $("#h1_tag_improvement").addClass('hidden');
                  }else{
                      $("#h1_tag_improvement").removeClass('hidden');
                      $("#h1_tag_good").addClass('hidden');
                  }

                  $("#h1_tag_problem").addClass('hidden');

                }else{
                    $("#h1_tag_problem").addClass('hidden');
                    $("#h1_tag_improvement").addClass('hidden');
                    $("#h1_tag_good").addClass('hidden');
                }

            });

          }  
          else{
              $("#h1_tag_problem").removeClass('hidden');
              $("#h1_tag_improvement").addClass('hidden');
              $("#h1_tag_good").addClass('hidden');
          }


      }else{
          $("#no_description_problem").removeClass('hidden');
          $("#h1_tag_improvement").addClass('hidden');
          $("#h1_tag_problem").addClass('hidden');
          $("#h1_tag_good").addClass('hidden');

      }

    }

    function subHeadingTags(description_html, focus_keyphrase){
      
      if(description != ''){

          var subheading_start_indexes = [];
          var subheading_end_indexes = [];

          var subheading_open = ['<h2', '<h3','<4', '<5', '<h6'];
          var subheading_close = ['</h2>', '</h3>','</4>', '</5>', '</h6>']

          var subheading_open_count = 0;
          var subheading_open_index  = 0;

          var subheading_close_count = 0;
          var subheading_close_index  = 0;

          $(subheading_open).each(function(index){
            
            while(true){
                
              subheading_open_index = description_html.indexOf(subheading_open[index], subheading_open_index);

              if(subheading_open_index != -1){ 
                subheading_open_count++; 
                
                subheading_start_indexes.push(subheading_open_index);

                subheading_open_index += subheading_open[index].length;
              }
              else{
                break;
              }
            }

          });


          $(subheading_close).each(function(index) {

            while(true){

              subheading_close_index = description_html.indexOf(subheading_close[index], subheading_close_index);

              if(subheading_close_index != -1){ 
                subheading_close_count++; 
                
                subheading_end_indexes.push(subheading_close_index);

                subheading_close_index += subheading_close[index].length;
              }
              else{
                break;
              }
                
            }

          });


          if(subheading_start_indexes != '' && subheading_open_count != 0){ 
            
            $(subheading_start_indexes).each(function(index){

              var subheading_tag = description_html.substring(subheading_start_indexes[index], subheading_end_indexes[index]);
              
              if(subheading_tag.toLowerCase().indexOf(focus_keyphrase) != -1){
                  $("#subheading_tag_good").removeClass('hidden');
                  $("#subheading_tag_improvement").addClass('hidden');
              }else{
                  $("#subheading_tag_improvement").removeClass('hidden');
                  $("#subheading_tag_good").addClass('hidden');
              }


               if(focus_keyphrase != ''){

                  if(subheading_tag.toLowerCase().indexOf(focus_keyphrase) != -1){
                      $("#subheading_tag_good").removeClass('hidden');
                      $("#subheading_tag_improvement").addClass('hidden');
                  }else{
                      $("#subheading_tag_improvement").removeClass('hidden');
                      $("#subheading_tag_good").addClass('hidden');
                  }

                }else{
                    $("#subheading_tag_improvement").addClass('hidden');
                    $("#subheading_tag_good").addClass('hidden');
                }

            });

          }else{
              $("#subheading_tag_improvement").addClass('hidden');
              $("#subheading_tag_good").addClass('hidden');

          }
          


      }else{
          $("#no_description_problem").removeClass('hidden');
          $("#subheading_tag_improvement").addClass('hidden');
          $("#subheading_tag_good").addClass('hidden');
      }

    }
   
    function paragraphLength(description_html, description_words){

      // paragraphs with more than 150 words
      var count_problem_paragraphs = 0;
      var problem_sections = []; 
      var paragraph_words = 0;
      var text = '';

      if(description != ''){
       
        var paragraphs       = description_html.split("</p>");

        $(paragraphs).each(function(index){

            if(paragraphs[index] != '' ){
                text = $(paragraphs[index]).text();
                
                if(text != ''){
                  paragraph_words = text.match(/\S+/g).length;
                }
            }

            if(paragraph_words > 150){
               count_problem_paragraphs++;
            }

            if(paragraph_words > 300){

              if(paragraphs[index].indexOf('</h2>') != -1 || paragraphs[index].indexOf('</h4>') != -1 || paragraphs[index].indexOf('</h4>') != -1 || paragraphs[index].indexOf('</h5>') != -1 || paragraphs[index].indexOf('</h6>') != -1){
                  
              }else{
                problem_sections.push(index);
              }

            }

        });   


        if(count_problem_paragraphs > 0){
            $("#paragraph_length_problem").removeClass('hidden');
            $("#paragraph_length_good").addClass('hidden');
        }else{
            $("#paragraph_length_good").removeClass('hidden');
            $("#paragraph_length_problem").addClass('hidden');
        }

        if(problem_sections != ''){
            $("#subheading_distribution_problem").removeClass('hidden');
        }else{
            $("#subheading_distribution_problem").addClass('hidden');
        }

        if(description_words < 150){
          $("#paragraph_length_good").removeClass('hidden');
          $("#paragraph_length_problem").addClass('hidden');
          $("#subheading_distribution_problem").addClass('hidden');
        }

      }else{
          $("#no_description_problem").removeClass('hidden');
          $("#sentence_length_improvement").addClass('hidden');
          $("#paragraph_length_problem").addClass('hidden');
          $("#subheading_distribution_problem").addClass('hidden');
          $("#paragraph_length_good").addClass('hidden');
          $("#subheading_distribution_problem").addClass('hidden');
          $("#subheading_tag_improvement").addClass('hidden');
          $("#subheading_tag_good").addClass('hidden');
          $("#ease_reading_problem").addClass('hidden');
          $("#h1_tag_problem").addClass('hidden');
          $("#h1_tag_improvement").addClass('hidden');
          $("#h1_tag_good").addClass('hidden');
      }

    }
    
    function improvementSentencesRatio(description_html){
      // sentences with more than 20 words
      var count_improvement_sentences = 0; 

        if(description != ''){

          var sentences       = description_html.split(". ");
          var total_sentences = description_html.split(". ").length;

          $(sentences).each(function(index){
              var sentence = sentences[index];

              var sentence_words = sentences[index].match(/\S+/g).length;

              if(sentence_words > 20){
                count_improvement_sentences++;
              }

          });   


          var improvement_sentences_ratio = (count_improvement_sentences / total_sentences) *100;

          if(improvement_sentences_ratio > 25){
              $("#sentence_length_improvement").removeClass('hidden');
              $("#sentence_length_good").addClass('hidden');
          }else{
              $("#sentence_length_good").removeClass('hidden');
              $("#sentence_length_improvement").addClass('hidden');
          }

        }else{
              $("#sentence_length_improvement").addClass('hidden');
              $("#sentence_length_good").addClass('hidden');
        }
  
    }

    function transitionWords(description) {

      var transition_words_status = 0;

      var transition_words = ['first of all', 'another', 'also', 'furthermore', 'finally', 'because','so', 'due to', 'for the reason that', 'similarly', 'likewise', 'rather', 'while', 'in contrast', 'as a result', 'hence', 'consequently', 'therefore', 'seems like', 'maybe', 'probably', 'almost', 'above all', 'most noteworthy', 'certainly', 'even more'];

      if(description != ''){
          
          $(transition_words).each(function(index){
              if(description.toLowerCase().indexOf(transition_words[index]) != -1){
                transition_words_status = 1;
              }
          });

          if(transition_words_status != 0){
              $("#transition_words_good").removeClass('hidden');
              $("#no_transition_words_problem").addClass('hidden');
          }else{
              $("#no_transition_words_problem").removeClass('hidden');
              $("#transition_words_good").addClass('hidden');
          }

      }else{
          $("#transition_words_good").addClass('hidden');
          $("#no_transition_words_problem").addClass('hidden');
      }
    
    }

    function imageAttributes(image_custom_title,image_custom_alt, focus_keyphrase) {

      if(thumb_image != ''){
        
          $("#no_image_problem").addClass('hidden');

          if(image_custom_alt != ''){

          $("#no_image_alt_improvement").addClass('hidden');

          if(focus_keyphrase != ''){

            if(image_custom_alt.toLowerCase().search(focus_keyphrase) != -1){
                $("#image_alt_improvement").addClass('hidden');
                $("#image_alt_good").removeClass('hidden');
            }else{
                $("#image_alt_good").addClass('hidden');
                $("#image_alt_improvement").removeClass('hidden');
            }

          }else{
                $("#image_alt_improvement").addClass('hidden');
                $("#image_alt_good").addClass('hidden');
          }

        }else{
            $("#no_image_alt_improvement").removeClass('hidden');
            $("#image_alt_improvement").addClass('hidden');
            $("#image_alt_good").addClass('hidden');
        }

        if(image_custom_title != ''){

            $("#no_image_title_improvement").addClass('hidden');

            if(focus_keyphrase != ''){

              if(image_custom_title.toLowerCase().search(focus_keyphrase) != -1){
                  $("#image_title_improvement").addClass('hidden');
                  $("#image_title_good").removeClass('hidden');
              }else{
                  $("#image_title_good").addClass('hidden');
                  $("#image_title_improvement").removeClass('hidden');
              }

            }else{
                  $("#image_title_improvement").addClass('hidden');
                  $("#image_title_good").addClass('hidden');
            }

        }else{
            $("#no_image_title_improvement").removeClass('hidden');
            $("#image_title_improvement").addClass('hidden');
            $("#image_title_good").addClass('hidden');
        }

      }else{
          $("#no_image_problem").removeClass('hidden');
          $("#image_title_improvement").addClass('hidden');
          $("#no_image_title_improvement").addClass('hidden');
          $("#image_title_good").addClass('hidden');
          $("#image_alt_improvement").addClass('hidden');
          $("#no_image_alt_improvement").addClass('hidden');
          $("#image_alt_good").addClass('hidden');
      }
      
    }



    function seoUrlKeyphrase(slug, focus_keyphrase) {
        
      if(slug != ''){

          $("#slug_good").removeClass('hidden');

        if(slug.toLowerCase().search(focus_keyphrase) != -1 ){
            $("#keyphrase_in_slug_good").removeClass('hidden');
            $("#keyphrase_in_slug_improvement").addClass('hidden');
            $("#keyphrase_in_slug_problem").addClass('hidden');
            $("#no_slug_problem").addClass('hidden');
        }else{
            $("#keyphrase_in_slug_improvement").removeClass('hidden');
            $("#keyphrase_in_slug_problem").addClass('hidden');
            $("#keyphrase_in_slug_good").addClass('hidden');
            $("#no_slug_problem").addClass('hidden');
        }  

      }else{
            $("#keyphrase_in_slug_problem").removeClass('hidden');
            $("#slug_good").addClass('hidden');
            $("#keyphrase_in_slug_good").addClass('hidden');
            $("#keyphrase_in_slug_improvement").addClass('hidden');
            $("#no_slug_problem").addClass('hidden');

      }

      if(focus_keyphrase == ''){
            $("#keyphrase_in_slug_problem").addClass('hidden');
            $("#keyphrase_in_slug_good").addClass('hidden');
            $("#keyphrase_in_slug_improvement").addClass('hidden');
      }
      
    }

    function checkKeyphraseDensity(focus_keyphrase) {
      
      var content = '';

      var description_with_html = $('.summernote').summernote('code').toLowerCase(); 

      if(description_with_html != '<p><br></p>'){
        content  += $(description_with_html).text()+' ';
      }

      content  += $("input[type='text'].meta_title").val()+' ';
      content  += $("input[type='text'].name").val()+' ';
      content  += $("textarea.meta_description").val()+' ';
      content  += $("input[type='text'].seo_url").val()+' ';
      
      if(thumb_image !=''){
        content  += $("input[type='text'].image_custom_title").val()+' ';
        content  += $("input[type='text'].image_custom_alt").val()+' ';
      }


      var all_content    = content.toLowerCase();

      var content_words   = all_content.match(/\S+/g).length;

      var keyphrase_count = 0;
      var position   = 0;

      if(all_content !='' && focus_keyphrase !=''){

        while(true){

            position = all_content.indexOf(focus_keyphrase, position);

            if(position != -1){ 
              keyphrase_count++; 
              position += focus_keyphrase.length;
            }
            else{
              break;
            }
        }

        var keyphrase_density = (keyphrase_count / content_words ) * 100;

        if(keyphrase_density >= 2.5){
          // problem
          $("#keyphrase_over_density_problem").removeClass('hidden');
          $("#keyphrase_low_density_improvement").addClass('hidden');
          $("#keyphrase_density_good").addClass('hidden');
        }else if(keyphrase_density >= 1 && keyphrase_density < 2.5 ){
          // good
          $("#keyphrase_density_good").removeClass('hidden');
          $("#keyphrase_over_density_problem").addClass('hidden');
          $("#keyphrase_low_density_improvement").addClass('hidden');
        }else{
          // improvement
          $("#keyphrase_low_density_improvement").removeClass('hidden');
          $("#keyphrase_density_good").addClass('hidden');
          $("#keyphrase_over_density_problem").addClass('hidden');
        }

      }

    }



    // description
    var description_html = $('.summernote').summernote('code').toLowerCase();

    var intro_start_index = description_html.indexOf('<p');
    var intro_end_index = description_html.indexOf('</p>');
    var description_intro_paragraph = '';
    var description_words = 0;

   
    // description 
    var description = $(description_html).text();

    // description words
    if(description != ''){
      description_words = description.match(/\S+/g).length;
      $("#description_words").text(description_words);
    }else{
      $("#description_words").text(0);
    }
    
     
    // description on change
    $(".summernote").on('summernote.change', function() {

      description_html = $('.summernote').summernote('code').toLowerCase();
      description      = $(description_html).text();

      // description words
      if(description != ''){
        description_words = description.match(/\S+/g).length;
        $("#description_words").text(description_words);
      }else{
        $("#description_words").text(0);
      }

      intro_start_index = description_html.indexOf('<p');
      intro_end_index = description_html.indexOf('</p>');

      categoryDescription(description_words, description);

      keyphraseInIntro(description_html, description, focus_keyphrase, intro_start_index, intro_end_index);
      
      checkSubHeadings(description_html);

      paragraphLength(description_html, description_words);

      improvementSentencesRatio(description_html);

      headingTags(description_html, focus_keyphrase);
      
      subHeadingTags(description_html, focus_keyphrase);

      transitionWords(description);

      checkLinks(description_html);

      checkKeyphraseDensity(focus_keyphrase);

      countMessageItems();

    });


    // image
    var thumb_image =  $("#input-image").val();

    // image title, alt
    var image_custom_title ='';
    var image_custom_alt ='';

    if(thumb_image != ''){

        image_custom_title = $("input[type='text'].image_custom_title").val();
        image_custom_alt   = $("input[type='text'].image_custom_alt").val();

        imageAttributes(image_custom_title,image_custom_alt, focus_keyphrase);

    }else{
        $("#no_image_problem").removeClass('hidden');
        $("#image_title_improvement").addClass('hidden');
        $("#no_image_title_improvement").addClass('hidden');
        $("#image_title_good").addClass('hidden');
        $("#image_alt_improvement").addClass('hidden');
        $("#no_image_alt_improvement").addClass('hidden');
        $("#image_alt_good").addClass('hidden');
    }

    // image on change
    $(document).on('change','#input-image',function(){

      thumb_image = $(this).val();

      image_custom_title = $("input[type='text'].image_custom_title").val();
      image_custom_alt   = $("input[type='text'].image_custom_alt").val();

      imageAttributes(image_custom_title,image_custom_alt, focus_keyphrase);

    });
    
    // image title on change
    $("input[type='text'].image_custom_title").on('keyup', function(){
       
      image_custom_title = $(this).val();

      imageAttributes(image_custom_title,image_custom_alt, focus_keyphrase);
      
      checkKeyphraseDensity(focus_keyphrase);
      
      countMessageItems();

    });

    // image alt on change
    $("input[type='text'].image_custom_alt").on('keyup', function(){
       
      image_custom_alt = $(this).val();

      imageAttributes(image_custom_title,image_custom_alt, focus_keyphrase);
      
      checkKeyphraseDensity(focus_keyphrase);
      
      countMessageItems();

    });



    // caetgory name
    var name = $("input[type='text'].name").val();

    // caetgory name on change
    $("input[type='text'].name").on('keyup', function(){
        name = $(this).val();
        checkKeyphraseDensity(focus_keyphrase);
    });



         // focus keyphrase items
    // problem items
    var keyphrase_problems_items = 0;
    // improvement items
    var keyphrase_improvements_items = 0;
    // good items
    var keyphrase_good_items = 0;
    var keyphrase_good_total_items = 0;
    // seo score
    var seo_score = 0;

    // readability analysis items
    // problem items
    var readability_problems_items = 0;
    // improvement items
    var readability_improvements_items = 0;
    var readability_improvements_total_items = 0;
    // good items
    var readability_good_items = 0;
    var readability_good_total_items = 0;
    // readability score
    var readability_score = 0;



    function problemItems(){
      // focus keyphrase problem items
      keyphrase_problems_items = $('#keyphrase_problems_list > li').not('.hidden').length;
      $("#keyphrase_problems_items").text(keyphrase_problems_items);
      
      // readability analysis problem items
      readability_problems_items = $('#readability_problems_list > li').not('.hidden').length;
      $("#readability_problems_items").text(readability_problems_items);
    }


    function improvementItems(){
      // focus keyphrase improvements items
      keyphrase_improvements_items = $('#keyphrase_improvements_list > li').not('.hidden').length;
      $("#keyphrase_improvements_items").text(keyphrase_improvements_items);

      // readability improvements items
      readability_improvements_total_items = $('#readability_improvements_list > li').length;
      readability_improvements_items = $('#readability_improvements_list > li').not('.hidden').length;
      $("#readability_improvements_items").text(readability_improvements_items);
    }


     function goodItems(){
      // focus keyphrase good items
      keyphrase_good_total_items = $('#keyphrase_good_list > li').length;
      keyphrase_good_items = $('#keyphrase_good_list > li').not('.hidden').length;
      $("#keyphrase_good_items").text(keyphrase_good_items);

      seo_score = (keyphrase_good_items/keyphrase_good_total_items)*100;
      
      // readability good items
      readability_good_total_items = $('#readability_good_list > li').length;
      readability_good_items = $('#readability_good_list > li').not('.hidden').length;
      $("#readability_good_items").text(readability_good_items);

      // exclude ease_reading_good which is not hidden in default

      if($("#ease_reading_good").not('.hidden')){
        
        readability_good_items = readability_good_items-1;
        readability_good_total_items = readability_good_total_items-1;

      }else{
        readability_good_total_items = readability_good_total_items-1;
      }

      readability_score = (readability_good_items/readability_good_total_items)*100;

      $("input[type='hidden'].seo_score").val(seo_score);
      $("input[type='hidden'].readability_score").val(readability_score);

      // seo score evaluation
      if(seo_score >= 70){ 

          $(".keyphrase_panel").find('i:first').removeClass('text-warning').removeClass('text-danger').addClass('text-success');

      }else if(seo_score >= 50 && seo_score < 70 ){

          $(".keyphrase_panel").find('i:first').removeClass('text-success').removeClass('text-danger').addClass('text-warning');

      }else if(seo_score > 0 && seo_score < 50){

          $(".keyphrase_panel").find('i:first').removeClass('text-success').removeClass('text-warning').addClass('text-danger');

      }
      else{

          $(".keyphrase_panel").find('i:first').removeClass('text-success').removeClass('text-warning').removeClass('text-danger').addClass('text-default');
      } 

      // readability score evaluation
      if(readability_score >= 60){ 

          $(".readability_panel").find('i:first').removeClass('text-warning').removeClass('text-danger').addClass('text-success');

          $("#ease_reading_good").removeClass('hidden');
          $("#ease_reading_improvement").addClass('hidden');
          $("#ease_reading_problem").addClass('hidden');

      }else if(readability_score >= 50 && readability_score < 60 ){

          $(".readability_panel").find('i:first').removeClass('text-success').removeClass('text-danger').addClass('text-warning');

          $("#ease_reading_improvement").removeClass('hidden');
          $("#ease_reading_good").addClass('hidden');
          $("#ease_reading_problem").addClass('hidden');

      }else if(readability_score > 0 && readability_score < 50 ){

          $(".readability_panel").find('i:first').removeClass('text-success').removeClass('text-warning').addClass('text-danger');

          $("#ease_reading_problem").removeClass('hidden');
          $("#ease_reading_improvement").addClass('hidden');
          $("#ease_reading_good").addClass('hidden');

      }else{

          $(".readability_panel").find('i:first').removeClass('text-success').removeClass('text-warning').removeClass('text-danger').addClass('text-default');

          $("#ease_reading_problem").addClass('hidden');
          $("#ease_reading_improvement").addClass('hidden');
          $("#ease_reading_good").addClass('hidden');
      }

      // again readability good items for included ease_reading_good item  
      readability_good_items = $('#readability_good_list > li').not('.hidden').length;
      $("#readability_good_items").text(readability_good_items);

    }

    function countMessageItems(){
      goodItems();
      problemItems();
      improvementItems();
    }


    $(document).ready(function() {

        focusKeyPhrase(focus_keyphrase, focus_keyphrase_words);

        checkPreviousKeyphrases(focus_keyphrase);

        metaTitleWidth(meta_title_width);

        metaTitleKeyphrase(meta_title, focus_keyphrase);

        metaDescriptionLength(meta_description_chars);

        metaDescriptionKeyphrase(meta_description, focus_keyphrase);

        categoryDescription(description_words, description);

        keyphraseInIntro(description_html, description, focus_keyphrase, intro_start_index, intro_end_index);

        paragraphLength(description_html, description_words);

        checkSubHeadings(description_html); // for readability

        headingTags(description_html, focus_keyphrase);

        subHeadingTags(description_html, focus_keyphrase);

        transitionWords(description);

        improvementSentencesRatio(description_html);

        checkLinks(description_html);

        checkKeyphraseDensity(focus_keyphrase);

        countMessageItems();

    });

</script>
<style type="text/css">
  .note-editor.note-frame .note-editing-area .note-editable {
    height: 300px;
  }
</style>
</div>
{{ footer }}
